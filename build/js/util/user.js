define("util/user",["util/cookie","util/ajax","api","util/hash"],function(a){var b=a("util/cookie"),c=a("util/ajax"),d=a("api"),e=a("util/hash"),f=function(){this.username=b.read("username"),this.token=b.read("token"),this.isLogin=function(){var a=this.username||b.read("username"),c=this.token||b.read("token");return a&&c?!0:!1},this.login=function(a,e,f,g){var h=this;c({url:d.login,type:"POST",data:{user_name:a,password:e},success:function(c){0==c.status&&c.token?(b.write("username",a,{duration:7}),b.write("token",c.token,{duration:7}),h.username=a,h.token=c.token,f&&f()):g&&g()},error:function(){g&&g()}})},this.logout=function(){b.remove("username"),b.remove("token"),this.username=null,this.token=null,e.set("login")}};return new f});