define("util/file",["jquery","underscore","util/adaptor","util/hash","api"],function(a){function b(a){var b="unknow-icon";if("dir"==a.type)b="folder-icon";else{var c=/\.[^\.]+$/.exec(a.name);switch(c&&(c=c[0]),c){case".pdf":b="pdf-icon";break;case".doc":b="word-icon";break;case".xls":b="xls-icon";break;case".zip":b="zip-icon";break;default:b="unknow-icon"}}return b}function c(a){var c=f(k({fileIcon:b(a),fileName:a.name}));return c.on("mouseenter",function(){f(this).addClass("hover")}).on("mouseleave",function(){f(this).removeClass("hover")}).on("click",function(){f(this).siblings().removeClass("click"),f(this).addClass("click"),h.set(a,f(this))}).on("dblclick",function(){"dir"==a.type?i.set("work"+a.path):window.open(j.download+a.path)}),c}function d(a){for(;"/"==a.path.substr(0,1)&&"/"==a.path.substr(1,1);)a.path=a.path.substr(1);return a}function e(){this.init=function(a){l.children("ul").html(""),a.sort(function(a,b){return a.name&&b.name&&a.name<b.name?-1:1});for(var b=[],c=[],d=0;d<a.length;d++){var e=a[d];e.status||("dir"==e.type?b.push(e):c.push(e))}a=b.concat(c);for(var d=0;d<a.length;d++){var e=a[d];e.status||this.add(e)}},this.add=function(a){l.children("ul").append(c(d(a)))},this.prepend=function(a){l.children("ul").prepend(c(d(a)))}}var f=a("jquery"),g=a("underscore"),h=a("util/adaptor"),i=a("util/hash"),j=a("api"),k=g.template(f("#file_template").html()),l=f(".file-con");return new e});